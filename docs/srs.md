# Спецификация требований (SRS)

## Введение
### Цели
Настоящая спецификация требований описывает программный продукт — Telegram-бот для поиска и контролируемого доступа к каталогу технической литературы компании. Документ определяет функциональные и нефункциональные требования, ограничения и допущения, которые используются при планировании, разработке, тестировании и приемке программного продукта в рамках производственной, технологической (проектно-технологической) практики.

### Соглашения о терминах
- Мессенджер — приложение, сервис для мгновенного обмена сообщениями, в том числе текстовыми.
- Бот, Telegram-бот — программное приложение, использующее Telegram Bot API и взаимодействующее с пользователем через чаты мессенджера Telegram.
- Гость — пользователь мессенджера, обращающийся к боту, для которого нет записи в таблице `users`.
- Зарегистрированный пользователь — пользователь, для которого назначена роль `REGULAR`
- Администратор — пользователь с ролью `ADMIN`, имеющий доступ к административным командам бота.
- Запрос на регистрацию — запись в таблице `auth_requests`, отражающая обращение гостя с просьбой предоставить доступ к функциональности бота.
- Каталог документов — совокупность файлов (PDF, DOCX, TXT и других поддерживаемых форматов), содержащих техническую литературу и размещенных в файловой системе сервера компании.
- Кэш извлеченного текста (индекс) — локальные текстовые файлы и вспомогательные метаданные, полученные в результате извлечения текста из исходных документов и используемые для поиска.
- Конфиденциальные данные — внутренние документы компании и сведения о пользователях, не подлежащие передаче третьим сторонам и внешним сервисам.

### Предполагаемая аудитория
Предполагаемая аудитория настоящей спецификации:
- студент-разработчик, выполняющий практику;
- руководитель практики от компании;
- руководитель практики от университета, контролирующий соответствие результатов требованиям образовательной программы.

### Масштаб проекта
Проект ограничивается разработкой и развертыванием Telegram-бота, который:
- использует Telegram как единственный пользовательский интерфейс;
- работает с одним внутренним каталогом документов, доступным через файловую систему сервера;
- реализует регистрацию пользователей через запрос доступа и подтверждение администратором;
- обеспечивает поиск по извлеченному тексту документов и выдачу файла через Telegram;
- не изменяет и не редактирует исходные документы;
- не использует платные внешние API и внешние сервисы хранения данных;
- развертывается на сервере организации.

Интеграция с другими внутренними системами, низкоуровневыми API и системами автоматизированного проектирования не входит в масштаб проекта.

## Общее описание
### Видение продукта
Продукт представляет собой сервисный инструмент для сотрудников организации, позволяющий структурированно и контролируемо получать доступ к технической литературе через интерфейс мессенджера Telegram. Бот должен сократить время поиска документов, уменьшить нагрузку на сотрудников, отвечающих за ручную отправку файлов, и обеспечить соблюдение требований по разграничению доступа к материалам.

### Функциональность продукта
На высоком уровне продукт предоставляет следующие функции:
- регистрация пользователей через запрос доступа и его утверждение администратором;
- разграничение доступа к командам и функциям на основе ролей (Гость, `REGULAR`, `ADMIN`);
- индексирование текстового содержимого документов и формирование локального кэша извлеченного текста;
- поиск документов по тексту и метаданным (на уровне имени файла или простых атрибутов);
- выдача пользователю выбранного документа через Telegram;
- управление пользователями и заявками на регистрацию со стороны администратора;
- просмотр статуса индексации и запуск процесса индексации администратором;

### Классы и характеристики пользователей
- Гости:
  - не зарегистрированы в системе;
  - имеют доступ к базовым командам (просмотреть список команд, отправить запрос на регистрацию);
  - не имеют доступа к поиску и выдаче документов.
- Зарегистрированные пользователи (`REGULAR`):
  - сотрудники, запрос которых на регистрацию был одобрен;
  - имеют доступ ко всем командам для гостей;
  - имеют доступ к поиску и выдаче документов;
  - не имеют доступа к административным командам.
- Администраторы (`ADMIN`):
  - сотрудники, ответственные за управление доступом и индексом;
  - имеют доступ ко всем функциям зарегистрированных пользователей;
  - имеют доступ к административным командам, позволяющим управлять статусом других пользователей и индексацией документов.

### Среда функционирования продукта (операционная среда)
Бот функционирует как серверное приложение, развернутое на сервере организации.
Предполагается использование средства контейнеризации (например, Docker), виртуальной машины языка Java (JVM) и встраиваемой СУБД для хранения служебных данных, включая данные о пользователях.
Документный каталог размещается в файловой системе сервера и доступен боту в режиме чтения. Взаимодействие с пользователями осуществляется через Telegram Bot API по протоколу HTTPS.

### Рамки, ограничения, правила и стандарты
- не допускается использование платных внешних API и коммерческих внешних сервисов хранения;
- конфиденциальные документы и извлеченный текст не должны передаваться во внешние web-сервисы (за исключением передачи файлов пользователю через Telegram по заданному протоколу);
- интеграция с системами автоматизированного проектирования и низкоуровневыми API не предусмотрена;
- при разработке должны учитываться требования законодательства Российской Федерации в области охраны труда, информационной безопасности и защиты персональных данных, а также внутренние регламенты организации.

### Документация для пользователей
Должны быть подготовлены следующие пользовательские материалы:
- краткое описание команд и ролей в файле README;
- инструкция по развертыванию и настройке (для технического персонала и администраторов);
- краткое текстовое описание работы с ботом, доступное в интерфейсе бота через специальные команды (например, `/help`).

### Допущения и зависимости
- предполагается, что у пользователей есть доступ к Telegram и возможность взаимодействовать с ботом;
- предполагается, что организация предоставляет стабильный доступ бота к документному каталогу через файловую систему;
- предполагается, что администраторам доступны средства управления сервером (например, запуск контейнера, просмотр логов);
- работоспособность бота зависит от доступности Telegram Bot API и сетевой связности между сервером и инфраструктурой Telegram;
- бот зависит от наличия и целостности установленной среды выполнения.

## Функциональность системы
### Функциональные требования
- **FR-1 Регистрация и роли**
  - Система должна поддерживать роли Гость, `REGULAR` и `ADMIN`.
  - Бот должен предоставлять гостю возможность отправить запрос на регистрацию через команду `/register`.
  - Администратор должен иметь возможность просматривать запросы, утверждать или отклонять их и регистрировать пользователя с указанной ролью.

- **FR-2 Управление пользователями и заявками**
  - Администратор должен иметь возможность просматривать список пользователей и их ролей.
  - Администратор должен иметь возможность регистрировать и удалять зарегистрированных пользователей.
  - Администратор должен иметь возможность просматривать и фильтровать заявки по статусу.

- **FR-3 Контроль доступа**
  - Гости не должны иметь доступа к поиску и выдаче документов. 
  - `REGULAR` и `ADMIN` должны иметь доступ к поиску и получению файлов. 
  - Административные команды должны быть доступны только пользователям с ролью `ADMIN`.
  - 
  
- **FR-4 Индексация**
  - Бот должен уметь обходить каталог документов, отбирать поддерживаемые типы файлов и извлекать из них текст.
  - Извлеченный текст должен сохраняться в локальный кэш (индекс) в отдельной директории.
  - Администратор должен иметь возможность запускать индексацию командой `/a_reindex` и просматривать статус индексации командой `/a_index_info`.

- **FR-5 Поиск и выдача документов**
  - Зарегистрированные пользователи должны иметь возможность выполнять поиск по тексту через команду `/search <query...>`.
  - Бот должен возвращать список найденных документов в виде сообщений и/или интерактивных кнопок.
  - Пользователь должен иметь возможность выбрать документ и получить исходный файл через Telegram.

## Требования к внешним интерфейсам
### Интерфейсы пользователя (UX)
Пользовательский интерфейс реализуется в виде команд и сообщений Telegram:
- текстовые команды (в том числе с аргументами);
- сообщения-ответы с краткими текстами и списками результатов;
- inline-кнопки для выбора документа, перехода к следующей части списка или изменения настроек.

Основной язык взаимодействия — русский.

### Программные интерфейсы
Бот взаимодействует со следующими программными интерфейсами:
- Telegram Bot API для приема и отправки сообщений и файлов;
- файловая система сервера для доступа к каталогу документов;
- встраиваемая СУБД (например, SQLite) для хранения пользователей, заявок на регистрацию и других служебных данных.

### Интерфейсы связи и коммуникации
Коммуникация с Telegram осуществляется по протоколу HTTPS в соответствии с официальной документацией Telegram Bot API. Доступ к документному каталогу осуществляется через локальную или сетевую файловую систему в пределах инфраструктуры организации. Внешние сетевые интерфейсы, кроме связи с Telegram, для пользовательских функций не используются.

## Нефункциональные требования
### Требования к удобству использования
- набор команд должен быть ограниченным и логически сгруппированным;
- команды и ответы должны иметь понятные описания на русском языке;
- для типичных сценариев (регистрация, поиск, получение документа) должно быть достаточно нескольких последовательных действий;
- команды, требующие авторизации, при вызове гостем должны корректно сообщать о необходимости регистрации и ссылаться на команду `/register`.

### Требования к сохранности (данных)
- исходные документы не должны изменяться ботом;
- локальный индекс (кэш извлеченного текста) должен храниться в отдельной директории и может быть восстановлен путем повторной индексации;
- данные о пользователях, ролях и заявках на регистрацию должны сохраняться в базе данных с учетом корректного завершения операций записи.

### Требования к качеству программного обеспечения
- код должен иметь модульную структуру с разделением ответственности (обработка команд, доступ к данным и т. д.);
- должны быть реализованы модульные тесты для ключевой бизнес-логики (контроль доступа, обработка заявок);
- в CI должны автоматически выполняться статический анализ и запуск тестов;
- при ошибках входных данных и внешних ресурсов бот не должен аварийно завершаться, должна выполняться обработка исключений с записью в лог.

### Требования к безопасности системы
- токен бота и другие секреты не должны храниться в системе контроля версий и должны передаваться через переменные окружения или отдельные конфигурационные механизмы;
- доступ к командам, связанным с поиском и выдачей документов, должен осуществляться только для зарегистрированных пользователей;
- административные команды должны быть доступны только пользователям с ролью `ADMIN`;
- конфиденциальные документы и извлеченный текст не должны передаваться во внешние web-сервисы, за исключением отправки файла через Telegram пользователю;
- должны учитываться требования законодательства Российской Федерации о персональных данных и внутренние положения организации о конфиденциальности.